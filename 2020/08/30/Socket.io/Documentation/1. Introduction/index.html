<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Introduction | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="What Socket.IO isSocket.IO is a library that enables real-time, bidirectional and event-based communication between the browser and the server. It consists of:  a Node.js server: Source | API a Javasc">
<meta property="og:type" content="article">
<meta property="og:title" content="Introduction">
<meta property="og:url" content="http://yoursite.com/2020/08/30/Socket.io/Documentation/1.%20Introduction/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="What Socket.IO isSocket.IO is a library that enables real-time, bidirectional and event-based communication between the browser and the server. It consists of:  a Node.js server: Source | API a Javasc">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://socket.io/images/bidirectional-communication.png">
<meta property="article:published_time" content="2020-08-30T07:46:37.000Z">
<meta property="article:modified_time" content="2020-09-01T02:36:50.305Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://socket.io/images/bidirectional-communication.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LilyMeng's Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a class="nav-icon" style="width: 46px" href="https://github.com/liyuan-meng" target="_blank">Github</a>
        
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Socket.io/Documentation/1. Introduction" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/30/Socket.io/Documentation/1.%20Introduction/" class="article-date">
  <time datetime="2020-08-30T07:46:37.000Z" itemprop="datePublished">2020-08-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Introduction
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="What-Socket-IO-is"><a href="#What-Socket-IO-is" class="headerlink" title="What Socket.IO is"></a>What Socket.IO is</h2><p>Socket.IO is a library that enables real-time, bidirectional and event-based communication between the browser and the server. It consists of:</p>
<ul>
<li>a Node.js server: <a href="https://github.com/socketio/socket.io" target="_blank" rel="noopener">Source</a> | <a href="https://socket.io/docs/server-api/" target="_blank" rel="noopener">API</a></li>
<li>a Javascript client library for the browser (which can be also run from Node.js): <a href="https://github.com/socketio/socket.io-client" target="_blank" rel="noopener">Source</a> | <a href="https://socket.io/docs/client-api/" target="_blank" rel="noopener">API</a></li>
</ul>
<p><img src="https://socket.io/images/bidirectional-communication.png" alt="Diagram for bidirectional communication"></p>
<p>There are also several client implementation in other languages, which are maintained by the community:</p>
<ul>
<li>Java: <a href="https://github.com/socketio/socket.io-client-java" target="_blank" rel="noopener">https://github.com/socketio/socket.io-client-java</a></li>
<li>C++: <a href="https://github.com/socketio/socket.io-client-cpp" target="_blank" rel="noopener">https://github.com/socketio/socket.io-client-cpp</a></li>
<li>Swift: <a href="https://github.com/socketio/socket.io-client-swift" target="_blank" rel="noopener">https://github.com/socketio/socket.io-client-swift</a></li>
<li>Dart: <a href="https://github.com/rikulo/socket.io-client-dart" target="_blank" rel="noopener">https://github.com/rikulo/socket.io-client-dart</a></li>
<li>Python: <a href="https://github.com/miguelgrinberg/python-socketio" target="_blank" rel="noopener">https://github.com/miguelgrinberg/python-socketio</a></li>
<li>.Net: <a href="https://github.com/Quobject/SocketIoClientDotNet" target="_blank" rel="noopener">https://github.com/Quobject/SocketIoClientDotNet</a></li>
</ul>
<p>Socket.IO是一个库，可用于在客户端和服务器之间进行实时，双向和基于事件的通信。它包括：</p>
<p>Node.js服务器： API<br>浏览器环境下运行的Javascript客户端（也可以从Node.js运行）： API</p>
<p>还有一些其他语言的客户端实现，由社区维护：</p>
<ul>
<li>Java：https：//github.com/socketio/socket.io-client-java</li>
<li>C ++：https：//github.com/socketio/socket.io-client-cpp</li>
<li>斯威夫特：<a href="https://github.com/socketio/socket.io-client-swift" target="_blank" rel="noopener">https://github.com/socketio/socket.io-client-swift</a></li>
<li>飞镖：https：//github.com/rikulo/socket.io-client-dart</li>
<li>Python：https：//github.com/miguelgrinberg/python-socketio</li>
<li>.Net：https：//github.com/Quobject/SocketIoClientDotNet</li>
</ul>
<h3 id="How-does-that-work"><a href="#How-does-that-work" class="headerlink" title="How does that work?"></a>How does that work?</h3><p>The client will try to establish a <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" target="_blank" rel="noopener">WebSocket</a> connection if possible, and will fall back on HTTP long polling if not.</p>
<p>WebSocket is a communication protocol which provides a full-duplex and low-latency channel between the server and the browser. More information can be found <a href="https://en.wikipedia.org/wiki/WebSocket" target="_blank" rel="noopener">here</a>.</p>
<p>So, in the best-case scenario, provided that:</p>
<ul>
<li>the browser supports WebSocket (<a href="https://caniuse.com/#search=websocket" target="_blank" rel="noopener">97%</a> of all browsers in 2020)</li>
<li>there is no element (proxy, firewall, …) preventing WebSocket connections between the client and the server</li>
</ul>
<p>you can consider the Socket.IO client as a “slight” wrapper around the WebSocket API. Instead of writing:</p>
<p>如果可能，客户端将尝试建立WebSocket连接，如果没有，客户端将使用HTTP长轮询。</p>
<p>WebSocket是一种通信协议，可在服务器和浏览器之间提供全双工和低延迟通道。更多信息可以在这里找到。</p>
<p>因此，在最佳情况下，应提供：</p>
<ul>
<li><p>浏览器支持WebSocket（2020年所有浏览器中的97％）</p>
</li>
<li><p>没有任何元素（代理，防火墙等）阻止客户端和服务器之间的WebSocket连接</p>
</li>
</ul>
<p>您可以将Socket.IO客户端视为WebSocket API的“轻量”包装器。而不是写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">'ws://localhost:3000'</span>);</span><br><span class="line"></span><br><span class="line">socket.onopen(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  socket.send(<span class="string">'Hello!'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">socket.onmessage(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>You will have, on the client-side:</p>
<p>在客户端，您将拥有：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> socket = io(<span class="string">'ws://localhost:3000'</span>);</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">'connect'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="comment">// either with send()</span></span><br><span class="line">  socket.send(<span class="string">'Hello!'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// or with emit() and custom event names</span></span><br><span class="line">  socket.emit(<span class="string">'salutations'</span>, <span class="string">'Hello!'</span>, &#123; <span class="string">'mr'</span>: <span class="string">'john'</span> &#125;, <span class="built_in">Uint8Array</span>.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// handle the event sent with socket.send()</span></span><br><span class="line">socket.on(<span class="string">'message'</span>, data =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// handle the event sent with socket.emit()</span></span><br><span class="line">socket.on(<span class="string">'greetings'</span>, (elem1, elem2, elem3) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(elem1, elem2, elem3);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The API on the server-side is similar, you also get an <code>socket</code> object which extends the Node.js <a href="https://nodejs.org/docs/latest/api/events.html#events_class_eventemitter" target="_blank" rel="noopener">EventEmitter</a> class:</p>
<p>服务器端的API与此类似，您还获得了一个扩展Node.js EventEmitter类的套接字对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> io = <span class="built_in">require</span>(<span class="string">'socket.io'</span>)(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">io.on(<span class="string">'connect'</span>, socket =&gt; &#123;</span><br><span class="line">  <span class="comment">// either with send()</span></span><br><span class="line">  socket.send(<span class="string">'Hello!'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// or with emit() and custom event names</span></span><br><span class="line">  socket.emit(<span class="string">'greetings'</span>, <span class="string">'Hey!'</span>, &#123; <span class="string">'ms'</span>: <span class="string">'jane'</span> &#125;, Buffer.from([<span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// handle the event sent with socket.send()</span></span><br><span class="line">  socket.on(<span class="string">'message'</span>, (data) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// handle the event sent with socket.emit()</span></span><br><span class="line">  socket.on(<span class="string">'salutations'</span>, (elem1, elem2, elem3) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(elem1, elem2, elem3);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Socket.IO provides additional features over a plain WebSocket object, which are listed <a href="https://socket.io/docs/#Features" target="_blank" rel="noopener">below</a>.</p>
<p>But first, let’s detail what the Socket.IO library is not.</p>
<p>Socket.IO在纯WebSocket对象上提供了其他功能，下面列出了这些功能。</p>
<p>但首先，让我们详细说明Socket.IO库不是什么。</p>
<h2 id="What-Socket-IO-is-not"><a href="#What-Socket-IO-is-not" class="headerlink" title="What Socket.IO is not"></a>What Socket.IO is not</h2><p>Socket.IO is <strong>NOT</strong> a WebSocket implementation. Although Socket.IO indeed uses WebSocket as a transport when possible, it adds additional metadata to each packet. That is why a WebSocket client will not be able to successfully connect to a Socket.IO server, and a Socket.IO client will not be able to connect to a plain WebSocket server either.</p>
<p>Socket.IO不是WebSocket实现。 尽管Socket.IO确实确实在可能的情况下使用WebSocket作为传输方式，但它向每个数据包添加了其他元数据。 这就是为什么WebSocket客户端将无法成功连接到Socket.IO服务器，而Socket.IO客户端也将无法连接到普通WebSocket服务器的原因。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// WARNING: the client will NOT be able to connect!</span></span><br><span class="line"><span class="keyword">const</span> socket = io(<span class="string">'ws://echo.websocket.org'</span>);</span><br></pre></td></tr></table></figure>

<p>If you are looking for a plain WebSocket server, please take a look at <a href="https://github.com/websockets/ws" target="_blank" rel="noopener">ws</a> or <a href="https://github.com/uNetworking/uWebSockets.js" target="_blank" rel="noopener">uWebSockets.js</a>.</p>
<p>There are also <a href="https://github.com/nodejs/node/issues/19308" target="_blank" rel="noopener">talks</a> to include a WebSocket server in the Node.js core.</p>
<p>On the client-side, you might be interested by the <a href="https://github.com/nathanboktae/robust-websocket" target="_blank" rel="noopener">robust-websocket</a> package.</p>
<p>如果您正在寻找普通的WebSocket服务器，请查看ws或uWebSockets.js。</p>
<p>也有讨论将WebSocket服务器包含在Node.js核心中。</p>
<p>在客户端，您可能会对robust-websocket软件包感兴趣。</p>
<h2 id="Minimal-working-example"><a href="#Minimal-working-example" class="headerlink" title="Minimal working example"></a>Minimal working example</h2><p>If you are new to the Node.js ecosystem, please take a look at the <a href="https://socket.io/get-started/chat" target="_blank" rel="noopener">Get Started</a> guide, which is ideal for beginners.</p>
<p>Else, let’s start right away! The server library can be installed from NPM:</p>
<p>如果您不熟悉Node.js生态系统，请查看《入门指南》，它是初学者的理想选择。</p>
<p>否则，我们马上开始！ 可以从NPM安装服务器库：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install socket.io</span><br></pre></td></tr></table></figure>

<p>More information about the installation can be found in the <a href="https://socket.io/docs/server-installation/" target="_blank" rel="noopener">Server installation</a> page.</p>
<p>Then, let’s create an <code>index.js</code> file, with the following content:</p>
<p>有关安装的更多信息，请参见“服务器安装”页面。</p>
<p>然后，我们创建一个index.js文件，其内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> content = <span class="built_in">require</span>(<span class="string">'fs'</span>).readFileSync(__dirname + <span class="string">'/index.html'</span>, <span class="string">'utf8'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> httpServer = <span class="built_in">require</span>(<span class="string">'http'</span>).createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// serve the index.html file</span></span><br><span class="line">  res.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/html'</span>);</span><br><span class="line">  res.setHeader(<span class="string">'Content-Length'</span>, Buffer.byteLength(content));</span><br><span class="line">  res.end(content);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> io = <span class="built_in">require</span>(<span class="string">'socket.io'</span>)(httpServer);</span><br><span class="line"></span><br><span class="line">io.on(<span class="string">'connect'</span>, socket =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'connect'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">httpServer.listen(<span class="number">3000</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'go to http://localhost:3000'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Here, a classic Node.js <a href="https://nodejs.org/docs/latest/api/http.html#http_class_http_server" target="_blank" rel="noopener">HTTP server</a> is started to serve the <code>index.html</code> file, and the Socket.IO server is attached to it. Please see the <a href="https://socket.io/docs/server-initialization/" target="_blank" rel="noopener">Server initialization</a> page for the various ways to create a server.</p>
<p>Let’s create the <code>index.html</code> file next to it:</p>
<p>在这里，启动了经典的Node.js HTTP服务器来提供index.html文件，并将Socket.IO服务器连接到该服务器。 有关创建服务器的各种方法，请参见服务器初始化页面。</p>
<p>让我们在它旁边创建index.html文件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Minimal working example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"events"</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/socket.io/socket.io.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> $events = <span class="built_in">document</span>.getElementById(<span class="string">'events'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> newItem = <span class="function">(<span class="params">content</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> item = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>);</span></span><br><span class="line">          item.innerText = content;</span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> item;</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> socket = io();</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        socket.on(<span class="string">'connect'</span>, () =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">          $events.appendChild(newItem(<span class="string">'connect'</span>));</span></span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Finally, let’s start our server:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node index.js</span><br></pre></td></tr></table></figure>

<p>![image-20200830095840462](/Users/liyuanmeng/Library/Application Support/typora-user-images/image-20200830095840462.png)</p>
<p>The <code>socket</code> object on both sides extends the EventEmitter class, so:</p>
<ul>
<li>sending an event is done with: <code>socket.emit()</code></li>
<li>receiving an event is done by registering a listener: <code>socket.on(, )</code></li>
</ul>
<p>两侧的套接字对象都扩展了EventEmitter类，因此：</p>
<p>发送事件的方法是：socket.emit（）<br>接收事件是通过注册侦听器完成的：socket.on（&lt;事件名称&gt;，&lt;监听器&gt;）</p>
<h3 id="To-send-an-event-from-the-server-to-the-client"><a href="#To-send-an-event-from-the-server-to-the-client" class="headerlink" title="To send an event from the server to the client"></a>To send an event from the server to the client</h3><p>Let’s update the <code>index.js</code> file (server-side):</p>
<p>让我们更新index.js文件（服务器端）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">io.on(<span class="string">'connect'</span>, socket =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> counter = <span class="number">0</span>;</span><br><span class="line">  setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    socket.emit(<span class="string">'hello'</span>, ++counter);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the <code>index.html</code> file (client-side):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> socket = io();</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">'connect'</span>, () =&gt; &#123;</span><br><span class="line">  $events.appendChild(newItem(<span class="string">'connect'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">'hello'</span>, (counter) =&gt; &#123;</span><br><span class="line">  $events.appendChild(newItem(<span class="string">`hello - <span class="subst">$&#123;counter&#125;</span>`</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>![image-20200830100611650](/Users/liyuanmeng/Library/Application Support/typora-user-images/image-20200830100611650.png)</p>
<h3 id="To-send-a-message-from-the-client-to-the-server"><a href="#To-send-a-message-from-the-client-to-the-server" class="headerlink" title="To send a message from the client to the server"></a>To send a message from the client to the server</h3><p>Let’s update the <code>index.js</code> file (server-side):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">io.on(<span class="string">'connect'</span>, socket =&gt; &#123;</span><br><span class="line">  socket.on(<span class="string">'hey'</span>, data =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hey'</span>, data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the <code>index.html</code> file (client-side):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> socket = io();</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">'connect'</span>, () =&gt; &#123;</span><br><span class="line">  $events.appendChild(newItem(<span class="string">'connect'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counter = <span class="number">0</span>;</span><br><span class="line">setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  ++counter;</span><br><span class="line">  socket.emit(<span class="string">'hey'</span>, &#123; counter &#125;); <span class="comment">// the object will be serialized for you</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>![image-20200830101114485](/Users/liyuanmeng/Library/Application Support/typora-user-images/image-20200830101114485.png)</p>
<p>Now, let’s detail the features provided by Socket.IO.</p>
<p>现在，让我们详细介绍Socket.IO提供的功能。</p>
<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><p>Its main features are:</p>
<h3 id="Reliability（可靠性）"><a href="#Reliability（可靠性）" class="headerlink" title="Reliability（可靠性）"></a>Reliability（可靠性）</h3><p>Connections are established even in the presence of:</p>
<ul>
<li>proxies and load balancers.</li>
<li>personal firewall and antivirus software.</li>
</ul>
<p>For this purpose, it relies on <a href="https://github.com/socketio/engine.io" target="_blank" rel="noopener">Engine.IO</a>, which first establishes a long-polling connection, then tries to upgrade to better transports that are “tested” on the side, like WebSocket. Please see the <a href="https://github.com/socketio/engine.io#goals" target="_blank" rel="noopener">Goals</a> section for more information.</p>
<p>即使存在以下情况也会建立连接：</p>
<ul>
<li>代理和负载均衡。</li>
<li>个人防火墙和防病毒软件。</li>
</ul>
<p>为此，它依赖Engine.IO，该引擎首先建立长轮询连接，然后尝试升级到在侧面进行“测试”的更好传输，例如WebSocket。 请参阅“目标”部分以获取更多信息。</p>
<h3 id="Auto-reconnection-support（自动重新连接支持）"><a href="#Auto-reconnection-support（自动重新连接支持）" class="headerlink" title="Auto-reconnection support（自动重新连接支持）"></a>Auto-reconnection support（自动重新连接支持）</h3><p>Unless instructed otherwise a disconnected client will try to reconnect forever, until the server is available again. Please see the available reconnection options <a href="https://socket.io/docs/client-api/#new-Manager-url-options" target="_blank" rel="noopener">here</a>.</p>
<p>除非另有指示，否则断开连接的客户端将尝试永久重新连接，直到服务器再次可用为止。 请在此处查看可用的重新连接选项。</p>
<h3 id="Disconnection-detection（断线检测）"><a href="#Disconnection-detection（断线检测）" class="headerlink" title="Disconnection detection（断线检测）"></a>Disconnection detection（断线检测）</h3><p>A heartbeat mechanism is implemented at the Engine.IO level, allowing both the server and the client to know when the other one is not responding anymore.</p>
<p>That functionality is achieved with timers set on both the server and the client, with timeout values (the pingInterval and pingTimeout parameters) shared during the connection handshake. Those timers require any subsequent client calls to be directed to the same server, hence the sticky-session requirement when using multiples nodes.</p>
<p>心跳机制在Engine.IO级别上实现，使服务器和客户端都可以知道另一方何时不再响应。</p>
<p>通过在服务器和客户端上设置计时器，并在连接握手期间共享超时值（pingInterval和pingTimeout参数），可以实现该功能。 这些计时器要求将任何后续客户端调用都定向到同一服务器，因此使用多个节点时需要执行粘性会话。</p>
<h3 id="Binary-support（二进制支持）"><a href="#Binary-support（二进制支持）" class="headerlink" title="Binary support（二进制支持）"></a>Binary support（二进制支持）</h3><p>Any serializable data structures can be emitted, including:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" target="_blank" rel="noopener">ArrayBuffer</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob" target="_blank" rel="noopener">Blob</a> in the browser</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" target="_blank" rel="noopener">ArrayBuffer</a> and <a href="https://nodejs.org/api/buffer.html" target="_blank" rel="noopener">Buffer</a> in Node.js</li>
</ul>
<p>可以发出任何可序列化的数据结构，包括：</p>
<ul>
<li><p>浏览器中的ArrayBuffer和Blob</p>
</li>
<li><p>Node.js中的ArrayBuffer和Buffer</p>
</li>
</ul>
<h3 id="Multiplexing-support（多路传输支持）"><a href="#Multiplexing-support（多路传输支持）" class="headerlink" title="Multiplexing support（多路传输支持）"></a>Multiplexing support（多路传输支持）</h3><p>In order to create separation of concerns within your application (for example per module, or based on permissions), Socket.IO allows you to create several <a href="https://socket.io/docs/rooms-and-namespaces/#Namespaces" target="_blank" rel="noopener">Namespaces</a>, which will act as separate communication channels but will share the same underlying connection.</p>
<p>为了在应用程序内创建关注点分离（例如，每个模块或基于权限），Socket.IO允许您创建多个命名空间，这些命名空间将充当单独的通信通道，但将共享相同的基础连接。</p>
<p>Caught a mistake? Edit this page on <a href="https://github.com/socketio/socket.io-website/blob/master/source/docs/index.md" target="_blank" rel="noopener">GitHub</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/30/Socket.io/Documentation/1.%20Introduction/" data-id="ckejc3t6p000avcxn60xlgl5p" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/08/30/Socket.io/server/5.%20Using%20multiple%20nodes/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Using multiple nodes
        
      </div>
    </a>
  
  
    <a href="/2020/08/30/Socket.io/server/3.%20Namespaces/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Namespaces</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/GridManager/" rel="tag">GridManager</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-%E4%B8%BA%E7%9F%A5%E7%AC%94%E8%AE%B0/" rel="tag">Linux 为知笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/GridManager/" style="font-size: 10px;">GridManager</a> <a href="/tags/Linux-%E4%B8%BA%E7%9F%A5%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">Linux 为知笔记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/30/Socket.io/client/2.%20Initialization/">Initialization</a>
          </li>
        
          <li>
            <a href="/2020/08/30/Socket.io/server/5.%20Using%20multiple%20nodes/">Using multiple nodes</a>
          </li>
        
          <li>
            <a href="/2020/08/30/Socket.io/Documentation/1.%20Introduction/">Introduction</a>
          </li>
        
          <li>
            <a href="/2020/08/30/Socket.io/server/3.%20Namespaces/">Namespaces</a>
          </li>
        
          <li>
            <a href="/2020/08/30/Socket.io/Introduction/">Introduction</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>